<div class="product-card">
  <!-- Stock Badge -->
  <div class="product-badge" [ngClass]="{'out-of-stock': product.qty === 0}">
    {{ product.qty > 0 ? product.qty + ' in stock' : 'Out of stock' }}
  </div>

  <!-- Product Image with loading state + RouterLink -->
  <a
    class="product-image-container"
    [routerLink]="['/product-detail']"
    [queryParams]="{ product_id: product.id }"
  >
    <img
      [src]="product.imageUrl"
      alt="{{ product.name }}"
      class="product-image"
      onerror="this.src='/no_image.png'"
      (load)="imageLoaded = true"
      [class.loaded]="imageLoaded"
    />
    <div class="image-placeholder" *ngIf="!imageLoaded"></div>
  </a>

  <!-- Product Info -->
  <div class="product-info">
    <h3 class="product-title" [title]="product.name">
      <a
        [routerLink]="['/product-detail']"
        [queryParams]="{ product_id: product.id }"
      >
        {{ product.name }}
      </a>
    </h3>

    <div class="product-pricing">
      <span class="current-price">
        {{ product.price | currency : "USD" : "symbol" : "1.2-2" }}
        <span class="khr-price">({{ product.price | usdToKhr }})</span>
      </span>
    </div>

    <!-- Add to Cart -->
    <input
      type="button"
      class="btn btn-outline-success btn-block mt-3"
      value="Add to Cart"
      (click)="onAddToCart(product)"
      [disabled]="product.stock === 0"
    />
  </div>
</div>
